---
title: "First Draft"
author: "Matthew Distell, Bo Aldridge, Haris Adnan, Lucan Franzblau, Devin Obee"
date: "2-25-2022"
output:
  pdf_document: default
  word_document: default
subtitle: 'due February 25, 2022 by 11:59 PM '
---


# Introduction: Motivation, Context, and our Question for Research


Ever since film itself became popularized in Western Culture at the beginning of
the 20th century, it has stood as one of the most popular forms of artistic 
creativity and expression. As such, the medium itself is able to showcase 
a wide variety of different subplots, themes, and genres. However, many movies 
today and historically follow a very similar pattern in the hopes of maximizing 
revenue and viewership. My research group and I are interested in what exactly
drives acclaim and viewership for fans as compared to critics. We believe that
critics view films in a different manner than fans, such that their criteria 
for "success" is far different from that of a fan reviewer. We also believe that 
these differences can be specified and categorically discussed through areas such
as genre, length, and country of origin. Our hypothesis is that lower budget movies
will, on average, perform better in critic reviews than fan reviews, and vice versa. 






# Load Packages

```{r load-packages, message = FALSE, warning = FALSE}
library(tidyverse) 
library(tidymodels)
install.packages("readxl")
library("readxl")
``` 


# Load Data
```{r load-data, message = F}
myMovieData <- read_csv("IMDB-Movie-Data.csv")
<<<<<<< HEAD

```
=======
```
# Introduction and Data
Please introduce and discuss your data here.

For our three datasets, we are using data called myMovieData, myMusicData, and
myNBAData. MyMovieData is collected from IMDB, or the International Movie 
Database. On that website, there is data listed for 1000 movies about 12 
different variables, including genre, director, year released, runtime, and 
audience rating. MyMusicData is collected from the Billboard100 Hot Charts 
that features 29503 songs featured on the chart. The variables in the set
include the runtime, loudness, performer, and genre of a given song. Finally, 
our myNbaData set analyzes the results of 9840 NBA games played from 2014-2018.
This dataset includes statistics such as Field Goal Percentage, Three Point 
Percentage, who the home team was, and rebounding. 

# Research Questions
Please discuss your research questions here.

1. Do critics prefer longer movies than fans? 
2. Are normal fans more likely to prefer action/adventure movies than a critic?
3. Other than runtime, what else causes a critic to enjoy a movie? 

For each of these three datasets, we have specific research questions designed
to answer interesting questions. For the myMovieData set, we plan on analyzing
the differences between critic reviews and fan reviews, and identify any trends
within that framework. More generally, our question is posed as: What do critics
prefer in a movie as compared to fans? Our brief hypothesis is that fans prefer
more action/adventure movies with shorter runtimes, while critics prefer longer
dramas. 
 
>>>>>>> d26ab6b102970f357b43d792d1ec62fa03a07487

# Glimpse

Please use `glimpse` for your datasets here.
```{r}
glimpse(myMovieData)

<<<<<<< HEAD
```
```{r popular}
popularMovies <- myMovieData %>% 
  filter(Votes >= 10000)
```


```{r convertIMDB}
popularMovies <- popularMovies %>% 
  mutate(newRating = Rating * 10)
```


# Results: Analyzing Box Office with Respect to Fan and Critic Ratings

```{r linearReg}
model1 <- linear_reg() %>% 
  set_engine("lm") %>% 
  fit(`Revenue (Millions)` ~ newRating + Metascore, data = popularMovies) 
tidy(model1)
```

The null hypothesis for each parameter is that each specific parameter does not
have a relationship with the net revenue generated by each movie. 

The alternative hypothesis, on the other hand, is that each specific parameter 
does have a relationship with the net revenue generated by each movie. 

This linear model shows that for every .1 unit rating in user score increase on
iMDB (or, on an out of 100 scale, a 1 unit increase), there is about, on 
average, a $1.5 million increase in revenue. This value is statistically 
significant since its p-value is below our alpha value of 0.05. 

This does not necessarily mean that critic rating was uncorrelated 
with net revenue, but it does mean that once you account for the one factor 
that was statistically significant (fan rating from iMDB), critic rating 
was not making as large of a difference there. In summary, critic scores failed 
to reject the null hypothesis, while fan rating from iMDB rejected the 
null hypothesis. 

scatterplot right here(box office vs critic reviews, box office vs. fan reviews)

# Results: Analyzing Genre vs. Critic and Fan Rating


```{r separatingActionsAndDramas}
popularMovies <- popularMovies %>% 
  mutate(action = str_detect(Genre, "Action")) %>% 
  mutate(drama = str_detect(Genre, "Drama")) %>% 
  filter(!(action == drama))

```

```{r}
popularMovies <- popularMovies %>% 
  mutate(critic_dif_fan = Metascore - newRating)
=======
>>>>>>> d26ab6b102970f357b43d792d1ec62fa03a07487
```
Does revenue increase along with rating? 

Visualize how revenue varies by year? Which year collected the most revenue 

Possible question: What is the probability that the metascore is the exact same as the rating?

<<<<<<< HEAD



```{r actualDifferenceInMeansAction}
mean_critic_action <- popularMovies %>% 
  filter(action == TRUE) %>% 
  summarise(mean_c_a = mean(Metascore, na.rm = TRUE)) %>% 
  pull()


mean_fan_action <- popularMovies %>% 
  filter(action == TRUE) %>% 
  summarise(mean_c_a = mean(newRating, na.rm = TRUE)) %>% 
  pull()

diff_mean_action <- mean_critic_action - mean_fan_action
  
```

```{r diffInMeanAction ex-3}
set.seed(3)
null_dif_mean_action <- popularMovies %>% 
  specify(response = critic_dif_fan, explanatory = action) %>% 
  hypothesise(null = "independence") %>% 
  generate(reps = 10000, type = "permute") %>%
  calculate(stat = "diff in means", order = c("TRUE", "FALSE"))

 null_dif_mean_action %>% 
   get_p_value(obs_stat = diff_mean_action, direction = "left")
```

```{r}
visualize(null_dif_mean_action) +
  shade_p_value(obs_stat = diff_mean_action, direction = "left")
```


```{r actualDifferenceInMeansDrama}
mean_critic_drama <- popularMovies %>% 
  filter(drama == TRUE) %>% 
  summarise(mean_c_a = mean(Metascore, na.rm = TRUE)) %>% 
  pull()


mean_fan_drama <- popularMovies %>% 
  filter(drama == TRUE) %>% 
  summarise(mean_c_a = mean(newRating, na.rm = TRUE)) %>% 
  pull()

diff_mean_drama <- mean_critic_drama - mean_fan_drama
  
```



```{r diffInMeanDrama ex-3}
set.seed(3)
null_dif_mean_drama <- popularMovies %>% 
  specify(response = critic_dif_fan, explanatory = drama) %>% 
  hypothesise(null = "independence") %>% 
  generate(reps = 10000, type = "permute") %>%
  calculate(stat = "diff in means", order = c("TRUE", "FALSE"))

 null_dif_mean_drama %>% 
   get_p_value(obs_stat = diff_mean_drama, direction = "right")
```



```{r}
visualize(null_dif_mean_drama) +
  shade_p_value(obs_stat = diff_mean_drama, direction = "right")
```

# Discussion

As showcased above, there is a clear and noticeable difference between the critic
rating of a movie (Metacritic) vs. the fan's rating of a movie (iMDB Rating) with 
regards to box office success. Critics, on average, tend to prefer movies of 
all types of box office success. This could be because critics have viewed more 
movies across their lifetime, and, as such, look for different characteristics 
in a film than the average fan. The average fan, on the other hand, might be more
invested in a huge blockbuster series, such as Star Wars, for instance, where 
the high rating could also be attributed to a general "cult following" mindset 
rather to a strict review of the quality of the film. 
=======
What is the probability a randomly selected movie has a rating over 7.0?
>>>>>>> d26ab6b102970f357b43d792d1ec62fa03a07487
