---
title: "April 20 - Turning in Final Report Document"
output: html_document
author: "Matthew Distell, Bo Aldridge, Haris Adnan, Lucan Franzblau, Devin Obee"
date: "4-19-2022"
---


## Load Packages 
```{r load-packages, message = FALSE, warning = FALSE}
library(tidyverse) 
library(tidymodels)
install.packages("readxl")
library("readxl")
``` 


# Load Data
```{r load-data, message = F}
myMovieData <- read_csv("IMDB-Movie-Data.csv")

```



## Introduction: Motivation and Context for the Research





## Dataset

```{r movie data}
glimpse(myMovieData)
```

This myMovieData set contains the title, genre, description, director, actors,
year of release, runtime, fan rating (Rating), number of fan votes, box office 
revenue, and critic rating (Metascore). For 1000 movies. 


## Research Questions

From these broader ideas regarding movies and the relationships between 
certain types of them, we narrowed our research into two specific areas:


1. What is the relationship between fan ratings and critic ratings with regards
to box office success? Do higher fan or critic ratings lead to more box office
success? And if so, which factor contributes more?

2. What is the relationship between fan ratings and critic ratings with regards
to certain genres of movies? Specifically, is there any difference between how
fans and critics view, for example, action movies, or dramas?


## Methodology Part 1

Before getting started, we wanted to only look at "popular" movies. We 
arbitrarily defined this as having over 8000 reviews on the iMDB database.
Those movies with lower than that total are filtered out. This excluded 
404 of the initial 1000 movies from myMovieData.

Next, we created a new variable called newRating, which adjusts the "out-of-10"
scale value of the iMDB rating, and puts it on an "out-of-100" scale, similar
to that of the Metacritic scoring. 

```{r popular movie filter}
popularMovies <- myMovieData %>% 
  filter(Votes >= 8000)
```

```{r IMDB}
popularMovies <- popularMovies %>% 
  mutate(newRating = Rating * 10)
```


## Part 1: The Relationship Between Fans vs. Critic Scoring and Box Office Revenue

```{r}
cor.test(popularMovies$newRating, popularMovies$`Revenue (Millions)`,
  method = "spearman"
)
```

```{r}
cor.test(popularMovies$Metascore, popularMovies$`Revenue (Millions)`,
  method = "spearman"
)
```



```{r linearReg}
model1 <- linear_reg() %>%
  set_engine("lm") %>%
  fit(`Revenue (Millions)` ~ newRating + Metascore, data = popularMovies)
tidy(model1)
```




```{r}
popularMovies %>% 
  ggplot(aes(x = newRating, y = `Revenue (Millions)`)) + 
  geom_point() + 
  geom_smooth(method = "lm", se = FALSE) 
  
```

```{r}
popularMovies %>% 
  ggplot(aes(x = Metascore, y = `Revenue (Millions)`)) + 
  geom_point() + 
  geom_smooth(method = "lm", se = FALSE) 
  
```

## Part 1 Results and Discussion

In our correlation model, we found that there was a stronger relationship
between fan ratings and box office success (.137) as compared to critic ratings 
and box office success (.082). 

Our linear model confirms some of these findings. The null hypothesis for each 
parameter in this model is that each specific parameter does not
have a relationship with the box office revenue of each specific movie.

The alternative hypothesis, on the other hand, is that each specific parameter 
does have a relationship with the box office revenue of each specific movie.

The only predictor that was significant at the alpha level of .05 was newRating, 
with a p-value of .00006 and a high t-value. 

The newRating slope indicates that with all else held constant, for each 1 unit 
this movie increases in rating, the movie will earn, on average, $2.9 million 
more at the box office. 

This does not necessarily mean that the other predictor, Metascore, was
uncorrelated with the outcome, but it does mean that once you account for the 
one factor that was statistically significant (newRating), the Metascore 
predictor in it of itself was not making as large of a difference there. 
Metascore predictor failed to reject the null hypothesis, while newRating
rejected the Null Hypothesis. 

Graphically, these same findings can be seen as well. There is a slightly 
stronger positive correlation between newRating and box office as compared to
Metascore and box office. This does not take into account the fact that the 
p-value was not found to be significant, meaning that while there still is a 
positive trend between Metascore and box office, we cannot comment on its 
specific strength of relation to box office with nearly as much certainty as 
we can with user ratings in newRating. 

## Part 2: Hypothesis Testing for the Difference in Genre Preferences Between Fans and Critics


```{r separatingActionsAndDramas}
popularMovies <- popularMovies %>%
  mutate(action = str_detect(Genre, "Action")) %>%
  mutate(drama = str_detect(Genre, "Drama")) %>%
  filter(!(action == drama))

```

```{r}
popularMovies <- popularMovies %>%
  mutate(critic_dif_fan = Metascore - newRating)

```

```{r load-data, message = F}

mean_critic_action <- popularMovies %>% 
  filter(action == TRUE) %>% 
  summarise(mean_c_a = mean(Metascore, na.rm = TRUE)) %>% 
  pull()


mean_fan_action <- popularMovies %>% 
  filter(action == TRUE) %>% 
  summarise(mean_c_a = mean(newRating, na.rm = TRUE)) %>% 
  pull()

diff_mean_action <- mean_critic_action - mean_fan_action
  
```



```{r diffInMeanAction ex-3}
set.seed(3)
null_dif_mean_action <- popularMovies %>% 
  specify(response = critic_dif_fan, explanatory = action) %>% 
  hypothesise(null = "independence") %>% 
  generate(reps = 10000, type = "permute") %>%
  calculate(stat = "diff in means", order = c("TRUE", "FALSE"))

 null_dif_mean_action %>% 
   get_p_value(obs_stat = diff_mean_action, direction = "both")
```


```{r}
visualize(null_dif_mean_action) +
  shade_p_value(obs_stat = diff_mean_action, direction = "both")
```




```{r actualDifferenceInMeansDrama}
mean_critic_drama <- popularMovies %>% 
  filter(drama == TRUE) %>% 
  summarise(mean_c_a = mean(Metascore, na.rm = TRUE)) %>% 
  pull()


mean_fan_drama <- popularMovies %>% 
  filter(drama == TRUE) %>% 
  summarise(mean_c_a = mean(newRating, na.rm = TRUE)) %>% 
  pull()

diff_mean_drama <- mean_critic_drama - mean_fan_drama
  
```



```{r diffInMeanDrama ex-3}
set.seed(3)
null_dif_mean_drama <- popularMovies %>% 
  specify(response = critic_dif_fan, explanatory = drama) %>% 
  hypothesise(null = "independence") %>% 
  generate(reps = 10000, type = "permute") %>%
  calculate(stat = "diff in means", order = c("TRUE", "FALSE"))

 null_dif_mean_drama %>% 
   get_p_value(obs_stat = diff_mean_drama, direction = "both")
```



```{r}
visualize(null_dif_mean_drama) +
  shade_p_value(obs_stat = diff_mean_drama, direction = "both")
```

## Part 2 Results and Discussion

